[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor
loglevel=info

[program:backend]
command=/app/logflux-api -f /app/etc/config.yaml
directory=/app
user=logflux
autostart=true
autorestart=true
startretries=3
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
priority=1

[program:caddy]
command=/usr/bin/caddy run --config /etc/caddy/Caddyfile --resume
user=logflux
environment=HOME="/data",XDG_CONFIG_HOME="/config",XDG_DATA_HOME="/data"
autostart=true
autorestart=true
startretries=3
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
priority=2
